<script>
(function(){
  const supportsHover = window.matchMedia('(hover: hover)').matches;
  if(!supportsHover) return; // en tÃ¡ctil, evitamos tilt (ya lo resolvimos por CSS)

  const MAX_TILT = 12; // grados
  const Z_LIFT = 20;   // px en translateZ para dar profundidad

  document.querySelectorAll('.tilt-card').forEach(card=>{
    let rafId = null;

    function handle(e){
      const rect = card.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;
      const x = (e.clientX - cx) / (rect.width/2);  // -1..1
      const y = (e.clientY - cy) / (rect.height/2); // -1..1
      const rx = (+y * MAX_TILT).toFixed(2);
      const ry = (-x * MAX_TILT).toFixed(2);

      if(rafId) cancelAnimationFrame(rafId);
      rafId = requestAnimationFrame(()=>{
        card.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg) translateZ(0)`;
      });
    }
    function reset(){
      if(rafId) cancelAnimationFrame(rafId);
      card.style.transform = '';
    }

    card.addEventListener('mousemove', handle);
    card.addEventListener('mouseleave', reset);
    card.addEventListener('blur', reset);
  });
})();
</script>
